---
import { getCollection } from 'astro:content';
import FormattedDate from './FormattedDate.astro';
import { Image } from 'astro:assets';

const { count = 3 } = Astro.props;

const posts = (await getCollection('blog')).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, count);
---

<ul style="display: flex; flex-wrap: wrap; gap: 2rem; list-style-type: none; margin: 0; padding: 0;">
  {
    posts.map((post) => (
      <li style="width: calc(50% - 1rem);">
        <a href={`/blog/${post.id}/`} style="text-decoration: none;">
          {post.data.heroImage && (
            <Image width={720} height={360} src={post.data.heroImage} alt="" style="margin-bottom: 0.5rem; border-radius: 12px;" />
          )}
          <h4 class="title" style="margin: 0; line-height: 1;">{post.data.title}</h4>
          <p class="date" style="margin: 0; color: gray;">
            <FormattedDate date={post.data.pubDate} />
          </p>
        </a>
      </li>
    ))
  }
</ul>

<style>
  @media (max-width: 720px) {
    ul {
      gap: 0.5em;
    }
    ul li {
      width: 100%;
      text-align: center;
    }
    .title {
      font-size: 1.3rem;
    }
  }
</style>
